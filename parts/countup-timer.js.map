{"version":3,"sources":["countup-timer.es"],"names":["CountupTimer","constructor","props","state","startTime","componentDidMount","startTick","componentWillReceiveProps","nextProps","countdownId","stopTick","setState","timeElapsed","getTimeElapsed","shouldComponentUpdate","nextState","componentDidUpdate","componentWillUnmount","window","ticker","reg","tick","unreg","currentTime","textLabel","textContent","tickCallback","startCallback","error","console","stack","render","ref","propTypes","string","isRequired","number","func","Date","now","Math","round","defaultProps"],"mappings":"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","file":"countup-timer.es","sourcesContent":["// similar to CountdownTimer in 'views/components/main/parts/countdown-timer.es', but it counts up\n\nimport React, { Component } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { resolveTime } from 'views/utils/tools'\n\n\nexport default class CountupTimer extends Component {\n  static propTypes = {\n    countdownId: PropTypes.string.isRequired, // UNIQUE ID to register to window.ticker\n    startTime: PropTypes.number, // startTime in ms\n    tickCallback: PropTypes.func, // callback function for each second\n    startCallback: PropTypes.func, // callback function when starting to count up\n  }\n  static getTimeElapsed = (startTime, currentTime = Date.now()) => {\n    if (startTime <= 0) {\n      return -1\n    } else if (startTime > currentTime) {\n      return 0\n    }\n    return Math.round((currentTime - startTime) / 1000)\n  }\n  static defaultProps = {\n    startTime: -1,\n    tickCallback: null,\n    startCallback: null,\n  }\n  constructor(props) {\n    super(props)\n    this.timeElapsed = this.constructor.getTimeElapsed(this.props.startTime)\n  }\n  state = {\n    startTime: this.props.startTime,\n  }\n  componentDidMount = () => {\n    this.startTick()\n  }\n  componentWillReceiveProps = (nextProps) => {\n    if (nextProps.countdownId !== this.props.countdownId) {\n      this.stopTick()\n    }\n    if (nextProps.startTime !== this.state.startTime) {\n      this.setState({ startTime: nextProps.startTime })\n      this.timeElapsed = this.constructor.getTimeElapsed(nextProps.startTime)\n    }\n  }\n  shouldComponentUpdate = (nextProps, nextState) =>\n    nextProps.countdownId !== this.props.countdownId || nextState.startTime !== this.state.startTime\n  componentDidUpdate = () => {\n    this.startTick() // Doesn't matter if it didn't stop\n  }\n  componentWillUnmount = () => {\n    this.stopTick()\n  }\n  startTick = () => {\n    window.ticker.reg(this.props.countdownId, this.tick)\n  }\n  stopTick = () => {\n    window.ticker.unreg(this.props.countdownId)\n  }\n  tick = (currentTime) => {\n    // const actualElapsed = this.constructor.getTimeElapsed(this.state.startTime, currentTime)\n    // if (Math.abs(this.timeElapsed - actualElapsed) > 2) {\n    //   this.timeElapsed = actualElapsed\n    // }\n    this.timeElapsed = this.constructor.getTimeElapsed(this.state.startTime, currentTime)\n    if (this.timeElapsed < 0) {\n      this.stopTick()\n    }\n    if (this.state.startTime >= 0) {\n      try {\n        if (this.textLabel) {\n          this.textLabel.textContent = resolveTime(this.timeElapsed) || resolveTime(0)\n        }\n        if (this.props.tickCallback) {\n          this.props.tickCallback(this.timeElapsed)\n        }\n        if (this.timeElapsed < 1 && this.props.startCallback) {\n          this.props.startCallback()\n        }\n      } catch (error) {\n        console.error(error.stack)\n      }\n    }\n    this.timeElapsed += 1\n  }\n  render() {\n    return <span ref={(ref) => { this.textLabel = ref }}>{resolveTime(this.timeElapsed)}</span>\n  }\n}\n"]}
